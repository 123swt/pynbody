

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pynbody &mdash; pynbody v0.13-alpha documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.13-alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="pynbody v0.13-alpha documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">pynbody v0.13-alpha documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pynbody</h1><pre>
=======

A light-weight, portable, format-transparent analysis framework
for N-body and SPH astrophysical simulations.

Getting help
------------

Help for pynbody comes in two forms

 1. The wiki, which is recommended for new users, at
      &lt;http://tinyurl.com/pynbody&gt;
 2. docstrings in the code for reference, which can be accessed
    using the standard help() function

What's available
----------------

Pynbody handles Gadget, Gadget-HDF and Tipsy files. To load
any of these, use

f = pynbody.load(filename)

to create a pynbody.snapshot.SimSnap object f, which then acts
as a dictionary holding the arrays inside f. For more information
see &lt;http://code.google.com/p/pynbody/wiki/BasicTutorial&gt;.

Configuration
-------------

Various aspects of the behaviour of pynbody can be controlled.
See &lt;http://code.google.com/p/pynbody/wiki/ConfigFiles&gt;

Subpackages
-----------

array
    Extends numpy arrays with a custom class array.SimArray
    which holds additional information like units.

bridge
    Allows connections to be made between two different
    SimSnap objects in various ways. 
    &lt;http://code.google.com/p/pynbody/wiki/SameSimulationDifferentOutputs&gt;
    

derived
    Holds procedures for creating new arrays from existing
    ones, e.g. for getting the radial position. 
    &lt;http://code.google.com/p/pynbody/wiki/AutomagicCalculation&gt;

family
    Stores a registry of different particle types like dm,
    star, gas.
    &lt;http://code.google.com/p/pynbody/wiki/TheFamilySystem&gt;

filt
    Defines and implements 'filters' which allow abstract subsets
    of data to be specified.
    &lt;http://code.google.com/p/pynbody/wiki/FiltersAndSubsims&gt;

gadget
    Implements classes and functions for handling gadget files;
    you rarely need to access this module directly as it will
    be invoked automatically via pynbody.load.

gadgethdf
    Implements classes and functions for handling gadget HDF files
    (if h5py is installed); you rarely need to access this module
    directly as it will be invoked automatically via pynbody.load

halo
    Implements halo catalogue functions. If you have a supported
    halo catalogue on disk or a halo finder installed and
    correctly configured, you can access a halo catalogue through
    f.halos() where f is a SimSnap.
    &lt;http://code.google.com/p/pynbody/wiki/HaloCatalogue&gt;

kdtree
    Implements a KD Tree based on Joachim Stadel's smooth.c.
    You are unlikely to need to access this module directly
    as KD Trees are built in higher level analysis code
    automatically.

snapshot
    Implements the basic SimSnap class and also SubSnap classes
    which can represent different views of the same data.
    &lt;http://code.google.com/p/pynbody/wiki/FiltersAndSubsims&gt;
    You rarely need to access this module directly.

sph
    Allows SPH images to be rendered. The easiest interface
    to this module, at least to start with, is through the
    pynbody.plot package.
    &lt;http://code.google.com/p/pynbody/wiki/SphImages&gt;

tipsy
    Implements classes and functions for handling tipsy files.
    You rarely need to access this module directly as it will
    be invoked automatically via pynbody.load.

units
    Implements a light-weight unit class which is
    used to automatically track units of your simulation arrays.
    &lt;http://code.google.com/p/pynbody/wiki/ConvertingUnits&gt;

util
    Various utility routines used internally by pynbody.

    
"""

# Import basic dependencies
import ConfigParser
import os
import imp
import numpy

# Create config dictionaries which will be required by subpackages
config_parser = ConfigParser.ConfigParser()
config = {}


# Process configuration options
config_parser.optionxform = str
config_parser.read(os.path.join(os.path.dirname(__file__),"default_config.ini"))
config_parser.read(os.path.join(os.path.dirname(__file__),"config.ini"))
config_parser.read(os.path.expanduser("~/.pynbodyrc"))
config_parser.read("config.ini")



config= {'verbose': config_parser.getboolean('general','verbose'),
         'tracktime': config_parser.getboolean('general','tracktime'),
         'centering-scheme': config_parser.get('general','centering-scheme')}

config['snap-class-priority'] = map(str.strip,
                                    config_parser.get('general', 'snap-class-priority').split(","))
config['halo-class-priority'] = map(str.strip,
                                    config_parser.get('general', 'halo-class-priority').split(","))


config['default-cosmology'] = {}
for k in config_parser.options('default-cosmology') :
    config['default-cosmology'][k] = float(config_parser.get('default-cosmology', k))


# Import subpackages
from . import util, filt, array, family, snapshot,  tipsy, gadget, gadgethdf, analysis, halo, derived, bridge, plot, gravity

# The following code resolves inter-dependencies when reloading
imp.reload(array)
imp.reload(util)
# imp.reload(family) # reloading this causes problems for active snapshots
imp.reload(snapshot)
imp.reload(tipsy)
imp.reload(gadget)
imp.reload(gadgethdf)
imp.reload(filt)
imp.reload(analysis)
imp.reload(halo)
imp.reload(derived)
imp.reload(bridge)
imp.reload(plot)
imp.reload(gravity)

# from analysis import profile


# This is our definitive list of classes which are able to
# load snapshots
_snap_classes = [gadgethdf.GadgetHDFSnap, gadget.GadgetSnap, tipsy.TipsySnap]

# Turn the config strings for snapshot/halo classes into lists of
# actual classes
_snap_classes_dict = dict([(x.__name__,x) for x in _snap_classes])
_halo_classes_dict = dict([(x.__name__,x) for x in halo._halo_classes])
config['snap-class-priority'] = [_snap_classes_dict[x] for x in config['snap-class-priority']]
config['halo-class-priority'] = [_halo_classes_dict[x] for x in config['halo-class-priority']]


def load(filename, *args, **kwargs) :
    """Loads a file using the appropriate class, returning a SimSnap
<div class="viewcode-block" id="load"><a class="viewcode-back" href="../pynbody.html#pynbody.load">[docs]</a>    instance."""
    for c in config['snap-class-priority'] :
        if c._can_load(filename) :
            if config['verbose'] : print "Attempting to load as",c
            return c(filename,*args,**kwargs)

    raise RuntimeError("File format not understood")


from snapshot import _new as new
</div>
__all__ = ['load', 'new']
</pre>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">pynbody v0.13-alpha documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, pynbody team (http://code.google.com/p/pynbody/people/list).
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.8.
    </div>
  </body>
</html>